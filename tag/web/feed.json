{
    "version": "https://jsonfeed.org/version/1",
    "title": "null • All posts by \"web\" tag",
    "description": "夜深忽夢少年事",
    "home_page_url": "http://meviv.github.io",
    "items": [
        {
            "id": "http://meviv.github.io/2022/07/08/%E6%B8%97%E9%80%8F/dedecms02/",
            "url": "http://meviv.github.io/2022/07/08/%E6%B8%97%E9%80%8F/dedecms02/",
            "title": "织梦系统渗透测试贰",
            "date_published": "2022-07-08T04:34:00.000Z",
            "content_html": "<p>登录后台管理系统</p>\n<span id=\"more\"></span>\n<h1 id=\"工具\"><a class=\"markdownIt-Anchor\" href=\"#工具\">#</a> 工具</h1>\n<p>Burpsuite</p>\n<h1 id=\"过程\"><a class=\"markdownIt-Anchor\" href=\"#过程\">#</a> 过程</h1>\n<p>前面登录管理员账户后，还没有成功登录网站后台，所以继续进行尝试<br>\n想要登录网站后台光靠 cookie 是不行的，得有正经的密码<br>\n原来的思路是修改密码时抓包<br>\n但是修改密码必须提供原密码，尝试几次后放弃了，还是尝试忘记密码重置<br>\n通过几次抓包都没有有用信息，Forward 后就返回了，<br>\n得设置个安全问题才能继续，最后用无安全问题进入重置<br>\n<img data-src=\"https://tva4.sinaimg.cn/large/007dFS7lly8h3zouozcfaj30r10b4gmx.jpg\" alt=\"\"><br>\n抓包，发到 repeater<br>\n<img data-src=\"https://tva2.sinaimg.cn/large/007dFS7lly8h3zovqgw1nj31hc0u0gr0.jpg\" alt=\"\"><br>\n 修改 id=1,userid=admin,safequestion=0.0, 发包<br>\n<img data-src=\"https://tva2.sinaimg.cn/large/007dFS7lly8h3zoyhj47aj31hc0u0tho.jpg\" alt=\"\"><br>\n得到一个网址，将 uploads 改为网站 ip<br>\n<img data-src=\"https://tva1.sinaimg.cn/large/007dFS7lly8h3zp0e2yq3j30cp04v74d.jpg\" alt=\"\"><br>\n 访问失败，再次观察网址发现 get 请求有错，得把两个 amp; 删掉<br>\n<img data-src=\"https://tva2.sinaimg.cn/large/007dFS7lly8h3zp3klke8j30qr0aj75f.jpg\" alt=\"\"><br>\n<img data-src=\"https://tva1.sinaimg.cn/large/007dFS7lly8h3zp413dpkj30ck04h74d.jpg\" alt=\"\"><br>\n成功进入并且修改管理账号密码<br>\n吊诡的是虽然显示修改成功但实际上密码还是错误 (为此我反复抓包修改搞了两个多小时)<br>\n 最后发现退出 admin 后 cookie 就删了，得保持 admin 账号登录的情况下新建标签页重置密码<br>\n<img data-src=\"https://tva3.sinaimg.cn/large/007dFS7lly8h3zpvj0ytlj31hc0u0q95.jpg\" alt=\"\"><br>\n再次抓包发到 repeater 并修改密码，修改后直接进入会员中心 - 系统设置<br>\n使用刚刚修改的密码重设<br>\n<img data-src=\"https://tva1.sinaimg.cn/large/007dFS7lly8h3zq7pskmkj30qq0mq40p.jpg\" alt=\"\"><br>\n<img data-src=\"https://tva1.sinaimg.cn/large/007dFS7lly8h3zq8gxr59j30cj04q0st.jpg\" alt=\"\"><br>\n打开 dede，登录网站后台管理系统<br>\n<img data-src=\"https://tva2.sinaimg.cn/large/007dFS7lly8h3zqmlkh9dj30cm04omxa.jpg\" alt=\"\"><br>\n成功进入网站后台</p>\n",
            "tags": [
                "渗透",
                "Web"
            ]
        },
        {
            "id": "http://meviv.github.io/2022/07/06/%E6%B8%97%E9%80%8F/dedecms01/",
            "url": "http://meviv.github.io/2022/07/06/%E6%B8%97%E9%80%8F/dedecms01/",
            "title": "织梦系统渗透测试壹",
            "date_published": "2022-07-06T11:41:29.000Z",
            "content_html": "<p>获得管理账户</p>\n<span id=\"more\"></span>\n<h2 id=\"工具\"><a class=\"markdownIt-Anchor\" href=\"#工具\">#</a> 工具</h2>\n<p>Burpsuite</p>\n<h2 id=\"过程\"><a class=\"markdownIt-Anchor\" href=\"#过程\">#</a> 过程</h2>\n<p>开始注册了一个 ID 为 viv 的账号，在登录时想要通过抓包修改 userid 来实现越权<br>\n于是我修改了 userid 为 1，并且修改了 userid 的 md5 加密值<br>\n发包后直接返回了登录页面<br>\n<img data-src=\"https://tva4.sinaimg.cn/large/007dFS7lly8h3yn2hx5wxj31hc0u044w.jpg\" alt=\"\"><br>\n<img data-src=\"https://tva4.sinaimg.cn/large/007dFS7lly8h3yn2u7qszj30ra0bodhb.jpg\" alt=\"\"><br>\n就知道没这么简单<br>\n再次抓包，发现这个账号 userid 的 md5 值与 md5 的直接加密值不一样，猜测还有一次加密<br>\n尝试了 b64 和一些加密方式后再进行 md5，还是没法对应<br>\n这时发现访问个人空间时会基于 id 生成对应的 ckMd5 值，想到如果用户名为 1 时，就直接有了对应的 ckMd5 值了<br>\n<img data-src=\"https://tva4.sinaimg.cn/large/007dFS7lly8h3yn4319ckj30r205g0t6.jpg\" alt=\"\"><br>\n于是注册一个用户名为 1 的账户<br>\n<img data-src=\"https://tva3.sinaimg.cn/large/007dFS7lly8h3yn4ubfxcj30cg04dglq.jpg\" alt=\"\"><br>\n注册失败了，用户名不够长，那就注册一个 00001 进行尝试<br>\n<img data-src=\"https://tva2.sinaimg.cn/large/007dFS7lly8h3yn5hmnsgj31hc0u07bj.jpg\" alt=\"\"><br>\n登录抓包，用 vid 替换 userid 的值，vid_ckMd5 替换 userid_ckMd5 的值<br>\n成功登录管理员账户<br>\n<img data-src=\"https://tva3.sinaimg.cn/large/007dFS7lly8h3yn5somwzj30qq0fv767.jpg\" alt=\"\"><br>\n F12 查看 cookie，修改 DedeUserID 和 DedeUserID__ckMd5 的值，与 vid 对应<br>\n<img data-src=\"https://tva1.sinaimg.cn/large/007dFS7lly8h3yn6ha50sj30r30a7myf.jpg\" alt=\"\"><br>\n返回网站首页，这时登录页面也变成了管理员账户，至此完成越权</p>\n",
            "tags": [
                "渗透",
                "Web"
            ]
        }
    ]
}